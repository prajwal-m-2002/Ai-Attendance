<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>Attendance ‚Äì AI Attendance</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <style>
      :root {
        --purple-deep: #9112bc;
        --purple-soft: #ae75da;

        --shadow-strong: 0 18px 45px rgba(145, 18, 188, 0.32);
        --radius-card: 26px;
      }
      /* Make the Attendance title a light pastel purple */
      .attendance-title {
        color: #d9b8ff !important; /* soft light purple */
        font-weight: 700;
      }

      body[data-theme="light"] {
        --bg: radial-gradient(circle at top, #ae75da 0, #2a073f 45%);
        --fg: #f9f5ff;
        --muted: #d1c4ff;

        --card-bg: linear-gradient(
          180deg,
          rgba(64, 8, 102, 0.95),
          rgba(18, 5, 30, 0.98)
        );

        --nav-chip-bg: rgba(0, 0, 0, 0.25);
        --nav-text: #ffffff;
      }

      body[data-theme="dark"] {
        --bg: radial-gradient(circle at top, #3d0c63 0, #13051d 45%);
        --fg: #f9f5ff;
        --muted: #c4b5fd;

        --card-bg: linear-gradient(
          180deg,
          rgba(34, 8, 58, 0.96),
          rgba(17, 6, 28, 0.98)
        );

        --nav-chip-bg: rgba(0, 0, 0, 0.2);
        --nav-text: #ffffff;
      }

      body {
        background: var(--bg);
        color: var(--fg);
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        padding-top: 90px;
      }

      .navbar {
        background: linear-gradient(
          90deg,
          var(--purple-deep),
          var(--purple-soft)
        );
      }

      .nav-chip {
        background: var(--nav-chip-bg);
        color: var(--nav-text);
        border-radius: 999px;
        padding: 0.2rem 0.8rem;
        font-size: 0.8rem;
      }

      .page-wrapper {
        min-height: 100vh;
      }

      .card-glass {
        background: var(--card-bg);
        border-radius: var(--radius-card);
        border: 1px solid rgba(255, 255, 255, 0.35);
        box-shadow: var(--shadow-strong);
        backdrop-filter: blur(22px);
      }

      /* ========= TABLE: LIGHT PURPLE BG + DARK TEXT ========= */

      /* Override Bootstrap table variables */
      .table {
        --bs-table-bg: #f3e6ff; /* light purple */
        --bs-table-striped-bg: #ebd6ff; /* slightly darker purple */
        --bs-table-hover-bg: #d6b5ff;
        --bs-table-border-color: rgba(120, 80, 160, 0.6);
        --bs-table-color: #2b0045; /* dark purple text */
      }

      /* Remove Bootstrap's white cell bg */
      .table > :not(caption) > * > * {
        background-color: transparent !important;
        color: var(--bs-table-color) !important;
        border-color: var(--bs-table-border-color) !important;
      }

      /* Apply row background ourselves */
      .table tbody tr {
        background-color: var(--bs-table-bg) !important;
      }

      .table tbody tr:nth-child(even) {
        background-color: var(--bs-table-striped-bg) !important;
      }

      .table tbody tr:hover {
        background-color: var(--bs-table-hover-bg) !important;
        color: #1b012e !important;
      }

      .table thead {
        background: rgba(145, 18, 188, 0.35);
      }

      .table thead th {
        color: #2b0045;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        border-color: var(--bs-table-border-color) !important;
      }

      /* Status pills */
      .badge-present {
        background: rgba(34, 197, 94, 0.2);
        color: #14532d;
        border-radius: 999px;
        padding: 6px 18px;
        font-weight: 600;
        border: 1px solid rgba(34, 197, 94, 0.6);
      }

      .badge-absent {
        background: rgba(248, 113, 113, 0.18);
        color: #7f1d1d;
        border-radius: 999px;
        padding: 6px 18px;
        font-weight: 600;
        border: 1px solid rgba(248, 113, 113, 0.7);
      }

      .date-input {
        background: rgba(34, 8, 58, 0.9);
        border-color: rgba(174, 117, 218, 0.7);
        color: var(--fg);
      }

      .date-input:focus {
        background: rgba(34, 8, 58, 1);
        color: var(--fg);
        box-shadow: none;
      }

      .text-hint {
        color: var(--muted);
      }
      /* Light pastel purple table header */
      .table thead th {
        color: #e7c8ff !important; /* soft bright lavender */
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .theme-toggle-btn {
        border-radius: 999px;
        font-size: 0.75rem;
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
      }
    </style>
  </head>

  <body data-theme="light">
    <nav class="navbar fixed-top navbar-dark shadow-sm">
      <div
        class="container-fluid px-4 d-flex justify-content-between align-items-center"
      >
        <a href="/dashboard" class="navbar-brand text-decoration-none">
          üß† AI Attendance
        </a>

        <div class="d-flex gap-2 align-items-center">
          <span class="nav-chip d-none d-md-inline"> Attendance Overview </span>

          <button
            id="themeToggle"
            type="button"
            class="btn btn-sm btn-outline-light theme-toggle-btn"
          >
            <span id="themeIcon">‚òÄÔ∏è</span>
            <span id="themeLabel" class="d-none d-sm-inline">Light</span>
          </button>

          <a href="/dashboard" class="btn btn-sm btn-outline-light">
            Dashboard
          </a>
        </div>
      </div>
    </nav>

    <div class="page-wrapper container py-4">
      <div class="card card-glass p-4">
        <div
          class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-3"
        >
          <div>
            <h4 class="mb-1 attendance-title">Attendance</h4>

            <div class="text-hint small">
              Showing records for
              <span th:text="${selectedDate}">2025-11-29</span>
            </div>
          </div>

          <form class="d-flex gap-2" method="get" action="/attendance">
            <input
              class="form-control form-control-sm date-input"
              type="date"
              name="date"
              th:value="${selectedDate}"
            />
            <button class="btn btn-sm btn-success" type="submit">Filter</button>
          </form>
        </div>

        <div class="table-responsive">
          <table class="table table-hover align-middle mb-0">
            <thead>
              <tr>
                <th>#</th>
                <th>Student</th>
                <th>Roll No</th>
                <th>Class</th>
                <th>Time</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr th:if="${#lists.isEmpty(records)}">
                <td colspan="6" class="text-center text-hint py-4">
                  No attendance records for this date.
                </td>
              </tr>

              <tr th:each="att, iter : ${records}">
                <td th:text="${iter.index + 1}">1</td>
                <td th:text="${att.student.name}">Prajwal</td>
                <td th:text="${att.student.rollNo}">1</td>
                <td th:text="${att.student.className}">MCA</td>
                <td th:text="${att.time}">10:05:12</td>
                <td>
                  <span
                    th:classappend="${att.status == 'PRESENT'} ? 'badge badge-present' : 'badge badge-absent'"
                    th:text="${att.status}"
                  >
                    PRESENT
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script>
      const themeToggle = document.getElementById("themeToggle");
      const themeIcon = document.getElementById("themeIcon");
      const themeLabel = document.getElementById("themeLabel");

      function applyTheme(theme) {
        document.body.setAttribute("data-theme", theme);
        localStorage.setItem("ai-attendance-theme", theme);
        if (theme === "dark") {
          themeIcon.textContent = "üåô";
          themeLabel.textContent = "Dark";
        } else {
          themeIcon.textContent = "‚òÄÔ∏è";
          themeLabel.textContent = "Light";
        }
      }

      const storedTheme =
        localStorage.getItem("ai-attendance-theme") || "light";
      applyTheme(storedTheme);

      themeToggle.addEventListener("click", () => {
        const current =
          document.body.getAttribute("data-theme") === "dark"
            ? "light"
            : "dark";
        applyTheme(current);
      });
    </script>
  </body>
</html>
