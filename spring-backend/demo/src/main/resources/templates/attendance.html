<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>Attendance ‚Äì AI Attendance</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <style>
      :root {
        --teal-main: #6dc3bb;
        --navy-dark: #242c54;
        --blue-mid: #404d96;
        --pink-soft: #f3b1c5;

        --shadow-strong: 0 18px 45px rgba(0, 0, 0, 0.6);
        --radius-card: 26px;
      }

      .attendance-title {
        color: #f3b1c5 !important;
        font-weight: 700;
      }

      body[data-theme="light"] {
        --bg: linear-gradient(180deg, #6dc3bb 0%, #404d96 45%, #f3b1c5 100%);
        --fg: #f4f8ff;
        --muted: #c1d0ff;

        --card-bg: linear-gradient(
          180deg,
          rgba(10, 15, 40, 0.96),
          rgba(4, 7, 20, 0.98)
        );

        --nav-chip-bg: rgba(0, 0, 0, 0.25);
        --nav-text: #f4f9ff;
      }

      body[data-theme="dark"] {
        --bg: radial-gradient(circle at top, #1e273f 0, #050814 55%);
        --fg: #e5eeff;
        --muted: #a4b7ff;

        --card-bg: linear-gradient(
          180deg,
          rgba(7, 12, 34, 0.96),
          rgba(3, 6, 18, 0.98)
        );

        --nav-chip-bg: rgba(0, 0, 0, 0.3);
        --nav-text: #eaf2ff;
      }

      body {
        background: var(--bg);
        color: var(--fg);
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        padding-top: 90px;
      }

      .navbar {
        background: linear-gradient(90deg, var(--navy-dark), var(--blue-mid));
      }

      .navbar-brand {
        font-weight: 700;
        letter-spacing: 0.04em;
      }

      .nav-chip {
        background: var(--nav-chip-bg);
        color: var(--nav-text);
        border-radius: 999px;
        padding: 0.2rem 0.8rem;
        font-size: 0.8rem;
      }

      .page-wrapper {
        min-height: 100vh;
      }

      .card-glass {
        background: var(--card-bg);
        border-radius: var(--radius-card);
        border: 1px solid rgba(255, 255, 255, 0.22);
        box-shadow: var(--shadow-strong);
        backdrop-filter: blur(22px);
      }

      /* ========= TABLE: dark navy rows with teal/blue accents ========= */
      .table {
        --bs-table-bg: rgba(20, 29, 70, 0.9);
        --bs-table-striped-bg: rgba(27, 40, 90, 0.95);
        --bs-table-hover-bg: rgba(38, 57, 120, 0.95);
        --bs-table-border-color: rgba(109, 195, 187, 0.6);
        --bs-table-color: #e5edff;
      }

      .table > :not(caption) > * > * {
        background-color: transparent !important;
        color: var(--bs-table-color) !important;
        border-color: var(--bs-table-border-color) !important;
      }

      .table tbody tr {
        background-color: var(--bs-table-bg) !important;
      }

      .table tbody tr:nth-child(even) {
        background-color: var(--bs-table-striped-bg) !important;
      }

      .table tbody tr:hover {
        background-color: var(--bs-table-hover-bg) !important;
        color: #f4f8ff !important;
      }

      .table thead {
        background: linear-gradient(
          90deg,
          rgba(36, 44, 84, 0.9),
          rgba(64, 77, 150, 0.95)
        );
      }

      .table thead th {
        color: #f3b1c5 !important;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        border-color: var(--bs-table-border-color) !important;
      }

      /* Status pills */
      .badge-present {
        background: rgba(34, 197, 94, 0.16);
        color: #bbf7d0;
        border-radius: 999px;
        padding: 6px 18px;
        font-weight: 600;
        border: 1px solid rgba(34, 197, 94, 0.7);
      }

      .badge-absent {
        background: rgba(248, 113, 113, 0.18);
        color: #fee2e2;
        border-radius: 999px;
        padding: 6px 18px;
        font-weight: 600;
        border: 1px solid rgba(248, 113, 113, 0.75);
      }

      .date-input {
        background: rgba(10, 18, 46, 0.95);
        border-color: rgba(109, 195, 187, 0.8);
        color: var(--fg);
      }

      .date-input:focus {
        background: rgba(10, 18, 46, 1);
        color: var(--fg);
        box-shadow: none;
      }

      .text-hint {
        color: var(--muted);
      }

      .btn-success {
        background: linear-gradient(90deg, var(--teal-main), var(--pink-soft));
        border: none;
        color: #041015;
        font-weight: 600;
      }

      .btn-success:hover {
        filter: brightness(1.05);
      }

      .btn-outline-light {
        border-radius: 999px;
        border-width: 1.5px;
        color: var(--nav-text);
        border-color: rgba(248, 250, 252, 0.8);
        background: transparent;
      }

      .btn-outline-light:hover {
        background: rgba(109, 195, 187, 0.18);
        color: var(--nav-text);
      }

      .theme-toggle-btn {
        border-radius: 999px;
        font-size: 0.75rem;
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
      }
    </style>
  </head>

  <body data-theme="light">
    <nav class="navbar fixed-top navbar-dark shadow-sm">
      <div
        class="container-fluid px-4 d-flex justify-content-between align-items-center"
      >
        <a href="/dashboard" class="navbar-brand text-decoration-none">
          üß† AI Attendance
        </a>

        <div class="d-flex gap-2 align-items-center">
          <span class="nav-chip d-none d-md-inline"> Attendance Overview </span>

          <button
            id="themeToggle"
            type="button"
            class="btn btn-sm btn-outline-light theme-toggle-btn"
          >
            <span id="themeIcon">‚òÄÔ∏è</span>
            <span id="themeLabel" class="d-none d-sm-inline">Light</span>
          </button>

          <a href="/dashboard" class="btn btn-sm btn-outline-light">
            Dashboard
          </a>
        </div>
      </div>
    </nav>

    <div class="page-wrapper container py-4">
      <div class="card card-glass p-4">
        <div
          class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-3"
        >
          <div>
            <h4 class="mb-1 attendance-title">Attendance</h4>

            <div class="text-hint small">
              Showing records for
              <span th:text="${selectedDate}">2025-11-29</span>
            </div>
          </div>

          <form class="d-flex gap-2" method="get" action="/attendance">
            <input
              class="form-control form-control-sm date-input"
              type="date"
              name="date"
              th:value="${selectedDate}"
            />
            <button class="btn btn-sm btn-success" type="submit">Filter</button>
          </form>
        </div>

        <div class="table-responsive">
          <table class="table table-hover align-middle mb-0">
            <thead>
              <tr>
                <th>#</th>
                <th>Student</th>
                <th>Roll No</th>
                <th>Class</th>
                <th>Time</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr th:if="${#lists.isEmpty(records)}">
                <td colspan="6" class="text-center text-hint py-4">
                  No attendance records for this date.
                </td>
              </tr>

              <tr th:each="att, iter : ${records}">
                <td th:text="${iter.index + 1}">1</td>
                <td th:text="${att.student.name}">Prajwal</td>
                <td th:text="${att.student.rollNo}">1</td>
                <td th:text="${att.student.className}">MCA</td>
                <td th:text="${att.time}">10:05:12</td>
                <td>
                  <span
                    th:classappend="${att.status == 'PRESENT'} ? 'badge-present' : 'badge-absent'"
                    th:text="${att.status}"
                  >
                    PRESENT
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script>
      const themeToggle = document.getElementById("themeToggle");
      const themeIcon = document.getElementById("themeIcon");
      const themeLabel = document.getElementById("themeLabel");

      function applyTheme(theme) {
        document.body.setAttribute("data-theme", theme);
        localStorage.setItem("ai-attendance-theme", theme);
        if (theme === "dark") {
          themeIcon.textContent = "üåô";
          themeLabel.textContent = "Dark";
        } else {
          themeIcon.textContent = "‚òÄÔ∏è";
          themeLabel.textContent = "Light";
        }
      }

      const storedTheme =
        localStorage.getItem("ai-attendance-theme") || "light";
      applyTheme(storedTheme);

      themeToggle.addEventListener("click", () => {
        const current =
          document.body.getAttribute("data-theme") === "dark"
            ? "light"
            : "dark";
        applyTheme(current);
      });
    </script>
  </body>
</html>
